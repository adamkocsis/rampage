<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Calibrated Color Ramps â€¢ rampage</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Calibrated Color Ramps">
<meta name="description" content="Value-calibrated color ramps can be useful to emphasize patterns in complex-distributed data. Colors can be tied to specific values (tiepoints), and the association can then be expanded into full color ramps, that explicitly record the relationship between colors and the values they represent. Such ramps can be used in a variety of cases when heatmap-type plots are necessary, including the visualization of vector and raster spatial data, such as topographies.">
<meta property="og:description" content="Value-calibrated color ramps can be useful to emphasize patterns in complex-distributed data. Colors can be tied to specific values (tiepoints), and the association can then be expanded into full color ramps, that explicitly record the relationship between colors and the values they represent. Such ramps can be used in a variety of cases when heatmap-type plots are necessary, including the visualization of vector and raster spatial data, such as topographies.">
<meta property="og:image" content="https://adamtkocsis.com/rampage/reference/figures/logo.png">
<meta property="og:image:alt" content="The rampage sticker.">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@atkocsis">
<meta name="twitter:site" content="@atkocsis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">rampage</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="articles/installation.html">1. Installation</a></li>
    <li><a class="dropdown-item" href="articles/topographies.html">2. Topographies</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-internals" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Internals</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-internals">
<li><a class="dropdown-item" href="news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adamkocsis/rampage/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="rampage">rampage<a class="anchor" aria-label="anchor" href="#rampage"></a>
</h1>
</div>
<p><a href="https://github.com/adamkocsis/rampage" class="external-link"><img src="https://img.shields.io/badge/devel%20version-0.2.0-green.svg"></a> <a href="https://cran.r-project.org/package=rampage" class="external-link"><img src="https://www.r-pkg.org/badges/version/rampage?color=blue"></a> <a href="https://cran.r-project.org/package=rampage" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/rampage?color=yellow"></a> <a href="https://doi.org/10.5281/zenodo.10546420." class="external-link"><img src="https://img.shields.io/badge/doi-10.5281/zenodo.10546420.-blue.svg"></a></p>
<div class="section level2">
<h2 id="stretchable-color-ramps">Stretchable Color Ramps<a class="anchor" aria-label="anchor" href="#stretchable-color-ramps"></a>
</h2>
<p>This package was written out of sheer anger. Many visulization tasks involve plotting heatmaps, where colors represent numeric values. There is a high number of extensions that have pre-defined components to make such representations with color palettes, but having precise control over the exact relationship between colors and values seems to be a constant technical nuissance. The <code>rampage</code> extension aims to make this control easier and allow users to construct and use color ramps based on explicit relationships between colors and values.</p>
</div>
<div class="section level2">
<h2 id="example-1-topographies">Example 1: Topographies<a class="anchor" aria-label="anchor" href="#example-1-topographies"></a>
</h2>
<p>Consider this coarsened version of the <a href="https://www.ncei.noaa.gov/products/etopo-global-relief-model" class="external-link">ETOPO topographic relief model</a> (0.25x0.25 degree resolution of the cell-registerd version of ETOPO1), using the widely-used extension package <code>terra</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://adamtkocsis.com/rampage/">rampage</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load data</span></span>
<span><span class="va">etopo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="st">"https://adamtkocsis.com/rampage/ETOPO1_ice_c_20110606_tiff_1.tif"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use a built-in dataset to get color to elevation bindings</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">topos</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the levels</span></span>
<span><span class="va">levs</span><span class="op">&lt;-</span> <span class="va">topos</span><span class="op">$</span><span class="va">etopo</span></span>
<span></span>
<span><span class="co"># expand and plot</span></span>
<span><span class="va">ramp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/expand.html">expand</a></span><span class="op">(</span><span class="va">levs</span>, n<span class="op">=</span><span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plotting</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">etopo</span>, col<span class="op">=</span><span class="va">ramp</span><span class="op">$</span><span class="va">col</span>, breaks<span class="op">=</span><span class="va">ramp</span><span class="op">$</span><span class="va">breaks</span>, legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/etopo.png"></p>
</div>
<div class="section level2">
<h2 id="example-2-heatmaps">Example 2: Heatmaps<a class="anchor" aria-label="anchor" href="#example-2-heatmaps"></a>
</h2>
<p>The visual message of a heatmap-figure is highly influenced by the dominance of specific colors in the heatmap. For instance, letâ€™s consider these example data that come form a slightly shifted (non-zero mean) Gaussian distribution:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://adamtkocsis.com/rampage/">rampage</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># random values in a matrix</span></span>
<span><span class="va">vals</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean<span class="op">=</span><span class="op">-</span><span class="fl">0.7</span>, sd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the histogram of the values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">vals</span>, breaks<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summarize-generics.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">vals</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/hist.png"></p>
<p>This small set of data is wrapped in a matrix to give the values some positional context, similar to spatial data. When these data are visualized, the automatic ramping will use the range of values provided for the plotting function: for instance, the default plotting with the <code>fields</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dnychka/fieldsRPackage" class="external-link">fields</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/fields/man/imagePlot.html" class="external-link">imagePlot</a></span><span class="op">(</span><span class="va">vals</span>, col<span class="op">=</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/flip.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="reference/ramps.html">gradinv</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/fields_default.png"></p>
<p>This solution is fine, if the goal of the heatmap is to visualize where the values are relative to the overall distribution, but not not where they are compared to some other value in the same dimension.</p>
<p>For example, assuming that the values represent changes from a previous state, it might be important to highlight the <code>0</code> level, clearly separating increases (positive) from decreases (negative values), for which we can use the yellow color. This task can be solved by defining a calbirated color ramp, that can be constructed with some value (<code>z</code>) to color (<code>color</code>) tiepoints in a <code>data.frame</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  color<span class="op">=</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/flip.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="reference/ramps.html">gradinv</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="do">##      z   color</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="do">## 1 -2.0 #690720</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="do">## 2 -0.5 #E22C28</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="do">## 3  0.0 #FFF99A</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="do">## 4  0.5 #76ACCE</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="do">## 5  2.0 #33358A</span></span></code></pre></div>
<p>This <code>data.frame</code> can than be expanded to a full, calibrated color ramp with the <code>expand</code> function. The resulting object can be used to control <code><a href="https://rdrr.io/pkg/fields/man/imagePlot.html" class="external-link">fields::imagePlot</a></code> via its <code>breaks</code> argument:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calibrated color ramp</span></span>
<span><span class="va">ramp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/expand.html">expand</a></span><span class="op">(</span><span class="va">df</span>, n<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="co"># check: str(ramp)</span></span>
<span></span>
<span><span class="co"># The modified color ramp </span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/fields/man/imagePlot.html" class="external-link">imagePlot</a></span><span class="op">(</span><span class="va">vals</span>, breaks<span class="op">=</span><span class="va">ramp</span><span class="op">$</span><span class="va">breaks</span>, col<span class="op">=</span><span class="va">ramp</span><span class="op">$</span><span class="va">col</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/fields_ramped.png"></p>
<p>This second figure shows the same data, but the red color now consistently indicates decreases over the visualized field.</p>
</div>
<div class="section level2">
<h2 id="connecting-to-additional-r-extensions">Connecting to additional R extensions<a class="anchor" aria-label="anchor" href="#connecting-to-additional-r-extensions"></a>
</h2>
<p>Using <code>fields</code> is just a single example. Many R packages rely on a similar <code>breaks</code> and <code>col</code> argument pair to explicitly control heatmap levels. These include (to mention a few), the <code>terra</code> and <code>sf</code> packages.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/adamkocsis/rampage/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/adamkocsis/rampage/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://creativecommons.org/licenses/by/4.0" class="external-link">CC BY 4.0</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rampage</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://palaeobiology.nat.fau.de/people/instructors/kocsis/" class="external-link">Adam T. Kocsis</a> <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0002-9028-665X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>
<a href="https://www.dfg.de/en/index.jsp" class="external-link"><img src="https://github.com/gplates/rgplates/blob/devel/pkgdown/assets/dfg.png?raw=true" alt="dfg" width="80"></a> <br><small class="roles"> Funder </small>  </li>
<li>
<a href="https://www.gzn.nat.fau.eu/" class="external-link"><img src="https://github.com/gplates/rgplates/blob/devel/pkgdown/assets/GeoZentrum.svg?raw=true" alt="geozentrum" width="80"></a> <br><small class="roles"> Funder </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://palaeobiology.nat.fau.de/people/instructors/kocsis/" class="external-link">Adam T. Kocsis</a>, <a href="https://www.dfg.de/en/index.jsp" class="external-link"><img src="https://github.com/gplates/rgplates/blob/devel/pkgdown/assets/dfg.png?raw=true" alt="dfg" width="80"></a>, <a href="https://www.gzn.nat.fau.eu/" class="external-link"><img src="https://github.com/gplates/rgplates/blob/devel/pkgdown/assets/GeoZentrum.svg?raw=true" alt="geozentrum" width="80"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
